<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Ski Car Tracker</title>

  <meta name="theme-color" content="#0f1115" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <link rel="manifest" href="/manifest.webmanifest" />
  <link rel="icon" href="/icon.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="/icons/icon-192.png" />

  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">ğŸš—</div>
      <div class="titles">
        <div class="title">Ski Car Tracker</div>
        <div class="subtitle" id="roomPill">Niet verbonden</div>
      </div>
    </div>

    <div class="topActions">
      <button class="ghost" id="installBtn" hidden>â¬‡ï¸ Installeren</button>
      <button class="ghost" id="openPanel" aria-label="Open menu">â˜°</button>
    </div>
  </header>

  <main class="main">
    <section class="mapWrap">
      <div id="map"></div>

      <div class="hud">
        <div class="hudCard">
          <div class="hudTitle">Bestemming</div>
          <div class="hudValue" id="hudDestValue">Nog niet ingesteld</div>
        </div>

        <div class="hudCard">
          <div class="hudTitle">Status</div>
          <div class="hudValue" id="hudStatus">Wachtenâ€¦</div>
        </div>
      </div>

      <div class="fabRow">
        <button class="fab" id="pauseBtn" disabled>â¸ Pauze</button>
        <button class="fab primary" id="start" disabled>â–¶ Start</button>
        <button class="fab danger" id="stop" disabled>â–  Stop</button>
      </div>

      <button class="miniHandle" id="miniHandle" aria-label="Open menu">â–² Menu</button>
    </section>

    <section class="sheet" id="sheet" aria-hidden="true">
      <div class="sheetHandle" id="sheetHandle"></div>

      <div class="sheetTabs">
        <button class="tab active" data-tab="tab-join">Join</button>
        <button class="tab" data-tab="tab-cars">Auto's</button>
        <button class="tab" data-tab="tab-dest">Bestemming</button>
        <button class="tab" data-tab="tab-msg">Meldingen</button>
        <button class="tab" data-tab="tab-settings">Instellingen</button>
      </div>

      <div class="sheetBody">
        <div class="tabPane active" id="tab-join">
          <div class="grid2">
            <div class="field">
              <label>Room code</label>
              <input id="room" placeholder="SAALBACH2026" />
            </div>
            <div class="field">
              <label>Auto naam</label>
              <input id="name" placeholder="Audi / Bus / Auto 3" />
            </div>
          </div>

          <div class="grid3">
            <div class="field">
              <label>Type</label>
              <select id="carType">
                <option value="car">ğŸš— Auto</option>
                <option value="bus">ğŸšŒ Bus</option>
                <option value="audi">ğŸš™ Audi</option>
              </select>
            </div>
            <div class="field">
              <label>Kleur</label>
              <input id="carColor" type="color" value="#65B832" />
            </div>
            <div class="field">
              <label>&nbsp;</label>
              <button id="share" class="btn" disabled>Deel link</button>
            </div>
          </div>

          <div class="actions">
            <button id="join" class="btn primary">Join room</button>
            <button class="btn ghost" id="closePanel">Sluiten</button>
          </div>

          <div class="hint">
            Locatie-permissie wordt gevraagd bij Join. iPhone: Safari moet open blijven voor live tracking.
          </div>
        </div>

        <div class="tabPane" id="tab-cars">
          <div class="hint">Tik op een auto om te selecteren. Zet â€œVolg geselecteerde autoâ€ aan om de kaart te laten volgen.</div>
          <div id="list" class="list"></div>
        </div>

        <div class="tabPane" id="tab-dest">
          <div class="hint">Alleen de room eigenaar kan de bestemming instellen (eerste die joint).</div>
          <div class="field">
            <label>Adres/plek</label>
            <input id="destLabel" placeholder="Saalbach Hinterglemm" />
          </div>
          <div class="actions">
            <button id="destSearch" class="btn" disabled>Zoek & stel in</button>
          </div>
          <div class="destInfo" id="destInfo">Nog geen bestemming ingesteld.</div>
        </div>

        <div class="tabPane" id="tab-msg">
          <div id="messages" class="messages"></div>
        </div>

        <div class="tabPane" id="tab-settings">
          <div class="grid2">
            <label class="switch">
              <input type="checkbox" id="followMe" checked />
              <span>Volg mij</span>
            </label>

            <label class="switch">
              <input type="checkbox" id="followSelected" />
              <span>Volg geselecteerde auto</span>
            </label>

            <label class="switch">
              <input type="checkbox" id="showRoutes" checked />
              <span>Toon routes</span>
            </label>

            <label class="switch">
              <input type="checkbox" id="enableAlerts" checked />
              <span>Meldingen</span>
            </label>
          </div>

          <div class="field inline">
            <label>Waarschuw binnen</label>
            <input id="alertKm" type="number" min="1" step="1" value="10" />
            <span>km</span>
          </div>

          <div class="actions">
            <button class="btn ghost" id="closePanel2">Sluiten</button>
          </div>

          <div class="hint">
            Installeren: Android/Chrome toont â€œInstallerenâ€. iPhone: Deel â–¸ â€œZet op beginschermâ€.
          </div>
        </div>
      </div>
    </section>

    <div class="toast" id="toast" aria-live="polite" aria-atomic="true"></div>
  </main>

  <script src="/socket.io/socket.io.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="app.js"></script>
</body>
</html>
